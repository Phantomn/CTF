#include <unistd.h>
#include <stdio.h>

inline unsigned long get_leak(unsigned long *addr)
{
    return *addr;
}

void vuln(void)
{
    unsigned long addr, r;
    char buf[16];

    do {
        printf("leak : ");
        scanf("%lu", &addr);
        getchar();

        r = get_leak((unsigned long *)addr);
        printf("0x%lx\n", r);
    } while (addr != 0);

    write(1, "> ", 2);
    read(0, buf, 256);
}

int main(int argc, const char *argv[])
{
    setvbuf(stdin, 0, 2, 0);
    setvbuf(stdout, 0, 2, 0);
    setvbuf(stderr, 0, 2, 0);

    vuln();
    return 0;
}