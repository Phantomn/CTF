#include <unistd.h>
#include <stdio.h>

void vuln(void)
{
    char stack[0];
    long idx;
    char buf[16];

    do {
        printf("leak : ");
        scanf("%ld", &idx);
        getchar();

        printf("0x%lx\n", *(long unsigned *)(stack+idx));
    } while (idx != 0);

    write(1, "> ", 2);
    read(0, buf, 256);
}

int main(int argc, const char *argv[])
{
    setvbuf(stdin, 0, 2, 0);
    setvbuf(stdout, 0, 2, 0);
    setvbuf(stderr, 0, 2, 0);

    vuln();
    return 0;
}